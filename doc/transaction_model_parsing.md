TransactionModel â€” The Universal Translator in Clean Architecture
This file is crucial in a Clean Architecture setup.
It acts as a translator between every possible representation of a transaction across layers.

ğŸ§© The Four Representations of a Transaction
A single transaction exists in four different forms inside the app:
1. Domain Entity
Transaction

Located in the domain layer
Pure Dart
No Flutter, no Drift, no HTTP
100% testable and independent
final transaction = Transaction(
  id: uuid.v4(),
  description: 'Taxi',
  amount: 25.0,
);

2. Drift Table Representation
TransactionTable

Autoâ€‘generated by Drift
Represents one row in the database

// Domain â†’ Model
final model = TransactionModel.fromEntity(transaction);

// Model â†’ Companion
final companion = model.toCompanion();

// Write to Drift
await into(transactions).insert(companion);
3. JSON Format
Map<String, dynamic>

What the API sends and receives
Pure data format for networking
// Drift row
final table = await (select(transactions)
  ..where((t) => t.isPendingSync.equals(true))
).getSingle();

// Table â†’ Model
final model = TransactionModel.fromTable(table);

// Model â†’ JSON
final json = model.toJson();

// Send to API
await apiClient.post('/transactions', body: json);
``

4. Model
TransactionModel

Lives in the data layer
Knows how to convert between:

Domain entity
Drift table
API JSON
Drift companion
// Response JSON
final json = response.data;

// JSON â†’ Model
final model = TransactionModel.fromJson(json);

// Model â†’ Domain Entity
final entity = model.toEntity();

// Returned to BLoC
return Right(entity);
``


It is literally the translator.

ğŸ—ï¸ TransactionTable vs TransactionModel
TransactionTable â€” Schema Definition
Dart// In app_database.dartclass Transactions extends Table {  TextColumn get id => text()();  TextColumn get description => text()();  RealColumn get amount => real()();  // ...}Show more lines
This is not actual data, it is the schema of the table.
Drift then generates:
Dartclass TransactionTable {  final String id;  final String description;  final double amount;  final DateTime date;  // ...}Show more lines
This class represents a real row in the database.

âœï¸ TransactionsCompanion â€” Insert / Update Helper
Drift uses a special helper class for writing operations.
âŒ You cannot insert using TransactionTable
Dartawait into(transactions).insert(TransactionTable(  id: '123',  description: 'Taxi',  // Missing required fields â†’ compile error));Show more lines
âœ… You must use TransactionsCompanion
Dartawait into(transactions).insert(  TransactionsCompanion.insert(    id: '123',    description: 'Taxi',    amount: 25.0,    date: DateTime.now(),    categoryId: 'cat_transport',  ),);``Show more lines
Using Value()
Any field wrapped in Value() means:
ğŸ‘‰ â€œI am manually providing this value.â€
DartTransactionsCompanion.insert(  id: id,  description: description,  amount: amount,  date: date,  categoryId: categoryId,  notes: Value(notes),  syncStatus: Value(syncStatus),);Show more lines

ğŸ”„ Full Conversion Flow (End-to-End)
This shows how the data travels through each layer.

1. User creates a transaction (UI â†’ Domain)
Dartfinal transaction = Transaction(  id: uuid.v4(),  description: 'Taxi',  amount: 25.0,);Show more lines

2. Repository saves to Drift
Dart// Domain â†’ Modelfinal model = TransactionModel.fromEntity(transaction);// Model â†’ Companionfinal companion = model.toCompanion();// Write to Driftawait into(transactions).insert(companion);Show more lines

3. Sync Engine sends to the server
Dart// Drift rowfinal table = await (select(transactions)  ..where((t) => t.isPendingSync.equals(true))).getSingle();// Table â†’ Modelfinal model = TransactionModel.fromTable(table);// Model â†’ JSONfinal json = model.toJson();// Send to APIawait apiClient.post('/transactions', body: json);``Show more lines

4. Server responds with fresh data
Dart// Response JSONfinal json = response.data;// JSON â†’ Modelfinal model = TransactionModel.fromJson(json);// Model â†’ Domain Entityfinal entity = model.toEntity();// Returned to BLoCreturn Right(entity);``Show more lines

ğŸ¯ Why So Many Conversions?
Because each layer has its own responsibility.

Domain Layer

Works with Transaction (Entity)
Pure Dart
Completely independent of:

Database
API
Flutter




Data Layer

Works with TransactionModel
Knows:

How to build a Domain Entity
How to convert to/from JSON
How to convert to/from Drift rows
How to create Drift Companions




Drift

Works with:

TransactionTable (read)
TransactionsCompanion (write)




API

Works with JSON:

Map<String, dynamic>




Without these conversions, the Domain Layer would depend on Drift and HTTP â†’
âŒ Clean Architecture would break.

ğŸ§­ Visual Summary
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Domain Entity (Transaction)           â”‚
â”‚          â†‘  Used by BLoC and business logic   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ TransactionModelâ”‚  â† Universal Translator
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚              â”‚                           â”‚
     â–¼              â–¼                           â–¼
 Drift Table     JSON API                Drift Companion
 (database)      (server)                (insert/update)


ğŸ—‚ï¸ Conversion Methods Provided by TransactionModel

































MethodDirectionfromTable()Drift â†’ ModelfromJson()API JSON â†’ ModelfromEntity()Domain â†’ ModeltoEntity()Model â†’ DomaintoJson()Model â†’ JSONtoCompanion()Model â†’ Drift
Each one handles a specific translation.

If you want, I can also generate:
âœ… A diagram (UML class diagram)
âœ… A developer cheatsheet
âœ… A complete folder structure for Clean Architecture
âœ… A fully implemented TransactionModel example
Just tell me!
Provide your feedback on BizChat